/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package QKART_SANITY_LOGIN;

import java.io.IOException;
import java.sql.Timestamp;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;

public class QkartSanity {

    public static void main(String[] args) throws InterruptedException, IOException {
        System.out.println("Initializing Test !! ");
        WebDriver driver;
        //IMPORTANT!: Enter the Driver Location here 
        String driverLocation = "/Users/praveenkumar/Documents/CrioDo/Java_Workspace_Grouping/Module1_2TCs_Non_Standard/app/chromedriver";//IMPORTANT!: Enter the Driver Location here 
        System.setProperty("webdriver.chrome.driver", driverLocation);

        driver = new ChromeDriver();

        System.out.print("Start Test: Test Case 1: Verify User Registration | completed @ "+java.time.LocalDateTime.now());

        driver.get("https://crio-qkart-frontend.vercel.app/register"); // Navigating to the register page URL

        WebElement usernameTxtBox = driver.findElement(By.id("username")); // Finding the Username Text Box

        Timestamp timeStamp = new Timestamp(System.currentTimeMillis()); // Get time stamp for generating a unique
                                                                         // username

        String testDataUsername = "new_user_TC1_" + String.valueOf(timeStamp.getTime()); // concatenate the timestamp
                                                                                           // to string to form unique
                                                                                           // timestamp
        
        usernameTxtBox.sendKeys(testDataUsername);// Type in username value

        Thread.sleep(2000); // Wait for username to be filled

        WebElement passwordTxtBox = driver.findElement(By.id("password")); // Finding the password Text Box

        String testDataPassword = "abc@123";

        passwordTxtBox.sendKeys(testDataPassword); // Entering the Password value

        Thread.sleep(1000); // Wait for the password to be filled up

        WebElement confirmPasswordTxtBox = driver.findElement(By.id("confirmPassword")); // Finding the Confirm
                                                                                            // password text box

        confirmPasswordTxtBox.sendKeys(testDataPassword); // Entering the Confirm Password Value

        WebElement registerNowButton = driver.findElement(By.className("button")); // Finding the register now button

        registerNowButton.click(); // clicking the register now button

        Thread.sleep(5000); // Waif for registration to complete

        driver.get("https://crio-qkart-frontend.vercel.app/login"); // Navigate to the Login Page

        usernameTxtBox = driver.findElement(By.id("username")); // Finding the Username Text Box
        usernameTxtBox.sendKeys(testDataUsername); // Enter the username in the login page

        Thread.sleep(1000); // Wait for user name to be entered

        passwordTxtBox = driver.findElement(By.id("password")); // Finding the password Text Box
        passwordTxtBox.sendKeys(testDataPassword);

        Thread.sleep(1000); // Wait for password to be entered

        WebElement loginButton = driver.findElement(By.className("button")); // Click on Login Button

        loginButton.click(); // click the login Button

        Thread.sleep(5000); // Wait for login to complete

        WebElement usernameLabel = driver.findElement(By.className("username-text")); // find the username label on the
                                                                                       // top right of the page
        String status = "";
        String usernameLabelActual = usernameLabel.getText();
        
        if (usernameLabelActual.equals(testDataUsername)) {
            status = "PASS";
            System.out.println("Test Case Verification Successful. User Logged in Successfully | completed @ "+java.time.LocalDateTime.now());

            WebElement logout_button = driver.findElement(By.className("MuiButton-text")); // Find the Logout Button

            logout_button.click();
        } else {
            status = "FAIL";
            System.out.println("Test Case Failure. User login verification failed");
        }

        System.out.println("End Test: Test Case 1: Verify user Regsitration : " + status);

        System.out.print("Start Test: Test Case 2: Verify User Registration with an existing username | completed @ "+java.time.LocalDateTime.now());

        driver.get("https://crio-qkart-frontend.vercel.app/register"); // Navigating to the register page URL

        usernameTxtBox = driver.findElement(By.id("username")); // Finding the Username Text Box

        usernameTxtBox.sendKeys(testDataUsername);// Type in the existing username

        Thread.sleep(2000); // wait for user name to be entered

        passwordTxtBox = driver.findElement(By.id("password")); // Finding the password Text Box

        passwordTxtBox.sendKeys(testDataPassword); // Entering the password Information

        Thread.sleep(2000); // wait for password to be entered

        confirmPasswordTxtBox = driver.findElement(By.id("confirmPassword")); // Finding the Confirm password text
                                                                                 // box

        confirmPasswordTxtBox.sendKeys(testDataPassword); // Entering the Confirm Password Value

        Thread.sleep(2000); // wait for Confirm password to be entered

        registerNowButton = driver.findElement(By.className("button")); // Finding the register now button

        registerNowButton.click(); // clicking the register now button

        Thread.sleep(3000); // Wait for register verification

        String current_url = driver.getCurrentUrl();

        if (current_url.equals("https://crio-qkart-frontend.vercel.app/register")) {
            status = "PASS";
            System.out.println("Test Case Verification Successful. Exising user cannot re-register | completed @ "+java.time.LocalDateTime.now());
        } else {
            status = "FAIL";
            System.out.println("Test Case Verification Failed. Exising user able to register | completed @ "+java.time.LocalDateTime.now());
        }

        System.out.println("End Test: Test Case 2: Verify user Re-Regsitration : " + status +"| completed @ "+java.time.LocalDateTime.now());

        driver.quit();

    }
}
